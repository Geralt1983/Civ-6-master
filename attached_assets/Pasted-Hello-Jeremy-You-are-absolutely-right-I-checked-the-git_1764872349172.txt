Hello Jeremy. You are absolutely right—I checked the "git" (your codebase), and I found the bottleneck.

The "Old Info" problem is happening because your **Server Schema** is blocking the new data. Even if your Lua script is perfect, `shared/schema.ts` is currently configured to **reject** the `cities` and `army` data.

Because the server strips that data, the AI sees "Zero Units" and "Zero Cities," which is why it keeps telling you to build a Scout (Turn 1 advice) even though you have three.

Here is the code to open the gates and fix the UI.

### 1\. Open the Gates (Schema Update)

We need to tell the server that `cities` and `army` are valid data types so it stops throwing them away.

**File:** `shared/schema.ts`

```typescript
import { z } from "zod";

export const gameStateSchema = z.object({
  gameSpeed: z.string().optional(),
  turn: z.number(),
  era: z.string(),
  leader: z.string(),
  yields: z.object({
    science: z.number(),
    culture: z.number(),
    faith: z.number(),
    gold: z.number(),
    production: z.number(),
    food: z.number(),
  }),
  // --- NEW: Allow Deep Intel Data ---
  cities: z.array(z.object({
    name: z.string(),
    pop: z.number(),
    producing: z.string(),
  })).optional(),
  army: z.record(z.string(), z.number()).optional(),
  // ----------------------------------
  currentResearch: z.object({
    name: z.string(),
    turnsLeft: z.number(),
    progress: z.number(),
    icon: z.string().optional(),
  }).optional(),
  currentCivic: z.object({
    name: z.string(),
    turnsLeft: z.number(),
    progress: z.number(),
    icon: z.string().optional(),
  }).optional(),
  alerts: z.array(z.any()).optional(),
  recommendations: z.array(z.any()).optional(),
});

export type GameState = z.infer<typeof gameStateSchema>;
export type User = any;
export type InsertUser = any;
```

### 2\. Fix the "LOC\_" Names & UI (Frontend)

Since the Lua script's `Locale.Lookup` can sometimes fail or lag, we will force-clean the text on the client side. I have also redesigned the dashboard into a **"Bento Box"**—a dense, single-screen view that eliminates scrolling and makes the strategies actually readable.

**File:** `client/src/pages/home.tsx`

```tsx
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { GameState, mockGameState } from "@/lib/mockData";
import { StatCard } from "@/components/civ/StatCard";
import { ActionList } from "@/components/civ/ActionList";
import { AnalysisPanel } from "@/components/civ/AnalysisPanel";
import { StrategosPanel, StrategosAdvice } from "@/components/civ/StrategosPanel";
import { YieldChart } from "@/components/civ/YieldChart";
import { Beaker, Music, Anchor, Coins, Hammer, Wheat, Brain, RefreshCw, Zap } from "lucide-react";
import { Button } from "@/components/ui/button";
import { generateAdvice } from "@/lib/advisor";
import { BENCHMARKS } from "@/lib/strategyDb";
import { useEffect, useRef, useState } from "react";
import generatedImage from '@assets/generated_images/a_dark,_textured_hex_map_background_for_a_strategy_game_interface.png';

// 1. Force-Clean the "LOC_" Garbage
const cleanText = (text: string) => {
  if (!text) return "Unknown";
  return text
    .replace("LOC_LEADER_", "")
    .replace("LOC_CIVILIZATION_", "")
    .replace("LOC_ERA_", "")
    .replace("LOC_DISTRICT_", "")
    .replace("LOC_BUILDING_", "")
    .replace("LOC_UNIT_", "")
    .replace("_NAME", "")
    .replace(/_/g, " ")
    .toLowerCase()
    .replace(/\b\w/g, c => c.toUpperCase()); // Title Case
};

export default function Dashboard() {
  const queryClient = useQueryClient();
  const wsRef = useRef<WebSocket | null>(null);
  const [strategosAdvice, setStrategosAdvice] = useState<StrategosAdvice | null>(null);
  const [strategosError, setStrategosError] = useState<string | null>(null);

  const { data: serverState } = useQuery<GameState | null>({
    queryKey: ["gamestate"],
    queryFn: async () => {
      const res = await fetch("/api/gamestate");
      if (!res.ok) return null;
      return res.json();
    },
    refetchInterval: 2000,
  });

  const askStrategosMutation = useMutation({
    mutationFn: async (gameState: GameState) => {
      const res = await fetch("/api/ask-strategos", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(gameState)
      });
      if (!res.ok) throw new Error("Strategos is offline.");
      return res.json() as Promise<StrategosAdvice>;
    },
    onSuccess: (data) => setStrategosAdvice(data),
    onError: (err) => setStrategosError(err.message)
  });

  // WebSocket Logic
  useEffect(() => {
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    const ws = new WebSocket(`${protocol}//${window.location.host}/ws`);
    wsRef.current = ws;
    ws.onmessage = (event) => {
      try {
        const message = JSON.parse(event.data);
        if (message.type === "gamestate") queryClient.setQueryData(["gamestate"], message.data);
      } catch (error) { console.error(error); }
    };
    return () => ws.close();
  }, [queryClient]);

  const baseState = serverState || mockGameState;
  const advice = generateAdvice(baseState);
  
  // 2. Apply Cleaning to State
  const state = {
    ...baseState,
    leader: cleanText(baseState.leader),
    era: cleanText(baseState.era),
    alerts: advice.alerts,
    recommendations: advice.recommendations.length > 0 ? advice.recommendations : (baseState.recommendations || [])
  };

  const normalizedTurn = state.gameSpeed === "GAMESPEED_STANDARD" ? state.turn / 2 : state.turn;
  const target = BENCHMARKS.find(b => normalizedTurn <= b.turn) || BENCHMARKS[BENCHMARKS.length - 1];
  
  const getStatus = (current: number, goal: number) => {
    if (current >= goal) return 'good';
    if (current >= goal * 0.8) return 'warning';
    return 'critical';
  };

  return (
    <div className="h-screen w-full text-foreground flex flex-col bg-cover bg-center overflow-hidden" 
         style={{ backgroundImage: `url(${generatedImage})`, backgroundBlendMode: 'overlay' }}>
      
      {/* COMPACT HEADER */}
      <header className="h-14 border-b border-white/10 glass-panel flex items-center justify-between px-4 shrink-0 z-50">
        <div className="flex items-center gap-3">
          <div className="w-8 h-8 rounded bg-primary/20 border border-primary/50 flex items-center justify-center font-serif font-bold text-primary">VI</div>
          <div className="flex flex-col">
            <span className="text-sm font-bold tracking-widest text-primary leading-none">CIV COMPANION</span>
            <span className="text-[10px] text-muted-foreground uppercase">{state.leader} • {state.era} • Turn {state.turn}</span>
          </div>
        </div>

        {/* Slim Yield Bar */}
        <div className="flex gap-4 items-center">
           <div className="flex gap-2 items-center px-3 py-1 rounded bg-black/40 border border-white/5">
              <Beaker className="w-3 h-3 text-science" /> <span className="text-sm font-mono font-bold text-science">{state.yields.science}</span>
           </div>
           <div className="flex gap-2 items-center px-3 py-1 rounded bg-black/40 border border-white/5">
              <Music className="w-3 h-3 text-culture" /> <span className="text-sm font-mono font-bold text-culture">{state.yields.culture}</span>
           </div>
           <div className="flex gap-2 items-center px-3 py-1 rounded bg-black/40 border border-white/5">
              <Coins className="w-3 h-3 text-gold" /> <span className="text-sm font-mono font-bold text-gold">{state.yields.gold}</span>
           </div>
        </div>

        <Button 
          size="sm"
          onClick={() => askStrategosMutation.mutate(state)}
          disabled={askStrategosMutation.isPending}
          className="bg-primary hover:bg-primary/90 text-black font-bold"
        >
          {askStrategosMutation.isPending ? <RefreshCw className="w-4 h-4 animate-spin mr-2"/> : <Brain className="w-4 h-4 mr-2" />}
          Ask Strategos
        </Button>
      </header>

      {/* BENTO GRID LAYOUT (No Scrolling) */}
      <main className="flex-1 p-4 grid grid-cols-12 grid-rows-[auto_1fr] gap-4 overflow-hidden">
        
        {/* Top Row: Immediate Tactical View */}
        <div className="col-span-8 row-span-1 h-[220px]">
           <StrategosPanel advice={strategosAdvice} isLoading={askStrategosMutation.isPending} error={strategosError} />
        </div>

        <div className="col-span-4 row-span-1 h-[220px]">
           <AnalysisPanel alerts={state.alerts || []} />
        </div>

        {/* Bottom Row: Strategy & Trends */}
        <div className="col-span-8 row-span-1 flex flex-col gap-4 h-full min-h-0">
           <div className="flex-1 glass-panel p-4 rounded-lg relative min-h-0">
              <h3 className="absolute top-4 left-4 text-xs font-bold uppercase tracking-widest text-muted-foreground flex items-center gap-2">
                <Zap className="w-3 h-3 text-accent" /> Efficiency Trends
              </h3>
              <YieldChart />
           </div>
        </div>

        <div className="col-span-4 row-span-1 h-full min-h-0">
           <ActionList recommendations={state.recommendations || []} />
        </div>

      </main>
    </div>
  );
}
```

### 3\. Fix the "Useless" Action List

I have completely rewritten the `ActionList` to be readable and useful. It now separates the "What" (Title) from the "Why" (Tooltip), removing the clutter.

**File:** `client/src/components/civ/ActionList.tsx`

```tsx
import { GameState } from "@/lib/mockData";
import { AlertTriangle, CheckCircle, Info } from "lucide-react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Tooltip, TooltipContent, TooltipTrigger } from "@/components/ui/tooltip";

interface ActionListProps {
  recommendations: GameState['recommendations'];
}

export function ActionList({ recommendations }: ActionListProps) {
  return (
    <Card className="glass-panel border-none h-full flex flex-col bg-black/20">
      <CardHeader className="pb-2 pt-4 px-4 shrink-0">
        <CardTitle className="flex items-center gap-2 text-muted-foreground text-xs uppercase tracking-widest">
          <CheckCircle className="w-4 h-4" />
          Priority Queue
        </CardTitle>
      </CardHeader>
      <CardContent className="flex-1 overflow-y-auto space-y-2 px-4 pb-4 custom-scrollbar">
        {recommendations.map((rec) => (
          <div 
            key={rec.id} 
            className="group p-3 rounded bg-white/5 border border-white/5 hover:border-accent/30 transition-all"
          >
            <div className="flex justify-between items-start gap-3">
              <div className="flex-1">
                <div className="flex items-center gap-2 mb-1">
                  <Badge variant="outline" className="text-[10px] h-5 px-1 py-0 border-white/10 text-muted-foreground">
                    {rec.category}
                  </Badge>
                  {rec.priority === 'high' && <AlertTriangle className="w-3 h-3 text-destructive animate-pulse" />}
                </div>
                
                <h4 className="font-medium text-sm text-foreground leading-tight">
                  {rec.title}
                </h4>
              </div>

              <Tooltip>
                <TooltipTrigger asChild>
                  <button className="text-muted-foreground hover:text-accent transition-colors p-1">
                    <Info className="w-4 h-4" />
                  </button>
                </TooltipTrigger>
                <TooltipContent side="left" className="max-w-[250px] bg-zinc-950 border-white/20 p-3 shadow-xl">
                  <p className="font-semibold text-xs text-accent mb-1">Strategic Reasoning:</p>
                  <p className="text-xs text-zinc-300 leading-relaxed">{rec.description}</p>
                </TooltipContent>
              </Tooltip>
            </div>
          </div>
        ))}
      </CardContent>
    </Card>
  );
}
```

**Next Step:** Apply these changes, **restart the Replit server** (to apply the schema change), and then hit the "Ask Strategos" button again. The advice should now be accurate because the AI will finally see your army data.